{
	"info": {
		"_postman_id": "f05e8325-4b47-4386-beeb-4d24901b172e",
		"name": "TFM - Microservicio Usuarios + Auth",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "39521410",
		"_collection_link": "https://tfm-bandas-2566.postman.co/workspace/TFM-Bandas-Workspace~d4517b4a-e234-4ee5-8c5b-0a7b11ca05fc/collection/39521410-f05e8325-4b47-4386-beeb-4d24901b172e?action=share&source=collection_link&creator=39521410"
	},
	"item": [
		{
			"name": "Get Keycloak MUSICIAN Token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"jsonData = pm.response.json();\r",
							"pm.environment.set(\"jwt_token\", jsonData.access_token);\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "client_id",
							"value": "frontend-local",
							"type": "text"
						},
						{
							"key": "username",
							"value": "ismablazquez",
							"type": "text"
						},
						{
							"key": "password",
							"value": "123456",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{keycloak_host}}/realms/{{realm}}/protocol/openid-connect/token",
					"host": [
						"{{keycloak_host}}"
					],
					"path": [
						"realms",
						"{{realm}}",
						"protocol",
						"openid-connect",
						"token"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get Keycloak ADMIN Token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"jsonData = pm.response.json();\r",
							"pm.environment.set(\"jwt_token\", jsonData.access_token);\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "client_id",
							"value": "frontend-local",
							"type": "text"
						},
						{
							"key": "username",
							"value": "admin",
							"type": "text"
						},
						{
							"key": "password",
							"value": "admin123",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{keycloak_host}}/realms/{{realm}}/protocol/openid-connect/token",
					"host": [
						"{{keycloak_host}}"
					],
					"path": [
						"realms",
						"{{realm}}",
						"protocol",
						"openid-connect",
						"token"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Get all",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/users?page=0&size=10&sort=email,asc",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users"
					],
					"query": [
						{
							"key": "page",
							"value": "0"
						},
						{
							"key": "size",
							"value": "10"
						},
						{
							"key": "sort",
							"value": "email,asc"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Get by ID",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/users/1",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"1"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Get by Email",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/users/email/admin@bandas.com",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"email",
						"admin@bandas.com"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Get by IAM Id",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/users/iam/fb97312f-0aa0-4aeb-9042-9dab0e46e4be",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"iam",
						"fb97312f-0aa0-4aeb-9042-9dab0e46e4be"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Create",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"iamId\": \"usuario123\",\n  \"username\": \"username\",\n  \"firstName\": \"Ismael\",\n  \"lastName\": \"Blázquez\",\n  \"secondLastName\": \"García\",\n  \"email\": \"ismael.blazquez@example.com\",\n  \"birthDate\": \"1990-05-15\",\n  \"bandJoinDate\": \"2020-09-01\",\n  \"systemSignupDate\": \"2024-06-10\",\n  \"phone\": \"600123456\",\n  \"notes\": \"Nuevo miembro\",\n  \"profilePictureUrl\": \"https://example.com/foto.jpg\",\n  \"instrumentIds\": [1, 2]\n}\n"
				},
				"url": {
					"raw": "{{users_host}}/api/users",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Update",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"iamId\": \"usuario123\",\n  \"username\": \"username\",\n  \"firstName\": \"Ismael\",\n  \"lastName\": \"Blázquez\",\n  \"secondLastName\": \"García\",\n  \"email\": \"ismael.blazquez@example.com\",\n  \"birthDate\": \"1990-05-15\",\n  \"bandJoinDate\": \"2020-09-01\",\n  \"systemSignupDate\": \"2024-06-10\",\n  \"phone\": \"600123456\",\n  \"notes\": \"Nuevo miembro\",\n  \"profilePictureUrl\": \"https://example.com/foto.jpg\",\n  \"instrumentIds\": [1, 2]\n}\n"
				},
				"url": {
					"raw": "{{users_host}}/api/users/22",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"22"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Enable",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/users/1/enable",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"1",
						"enable"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Disable",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/users/1/disable",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"1",
						"disable"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Delete",
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/users/1",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"1"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Assign instruments",
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "[\n  1\n]"
				},
				"url": {
					"raw": "{{users_host}}/api/users/22/assign-instruments",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"22",
						"assign-instruments"
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Search",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{users_host}}/api/users/search?page&size",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"search"
					],
					"query": [
						{
							"key": "firstName",
							"value": null,
							"disabled": true
						},
						{
							"key": "lastName",
							"value": null,
							"disabled": true
						},
						{
							"key": "email",
							"value": null,
							"disabled": true
						},
						{
							"key": "active",
							"value": null,
							"disabled": true
						},
						{
							"key": "instrumentId",
							"value": null,
							"disabled": true
						},
						{
							"key": "page",
							"value": null
						},
						{
							"key": "size",
							"value": null
						},
						{
							"key": "sort",
							"value": null,
							"disabled": true
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Users - Get My Profile",
			"request": {
				"auth": {
					"type": "bearer"
				},
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/users/me",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"users",
						"me"
					]
				}
			},
			"response": []
		},
		{
			"name": "Instruments - Get all",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/instruments?page=0&size=20&sort=id,asc",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"instruments"
					],
					"query": [
						{
							"key": "page",
							"value": "0"
						},
						{
							"key": "size",
							"value": "20"
						},
						{
							"key": "sort",
							"value": "id,asc"
						}
					]
				}
			},
			"response": []
		},
		{
			"name": "Instruments - Get by ID",
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/instruments/1",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"instruments",
						"1"
					]
				}
			},
			"response": []
		},
		{
			"name": "Instruments - Create",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"instrumentName\": \"Percusión\",\n  \"voice\": \"1\"\n}"
				},
				"url": {
					"raw": "{{users_host}}/api/instruments",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"instruments"
					]
				}
			},
			"response": []
		},
		{
			"name": "Instruments - Delete",
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"url": {
					"raw": "{{users_host}}/api/instruments/3",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"instruments",
						"3"
					]
				}
			},
			"response": []
		},
		{
			"name": "Instruments- Search",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					},
					{
						"key": "Authorization",
						"value": "Bearer {{jwt_token}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": {
					"raw": "{{users_host}}/api/instruments/search?instrumentName=percu&page=0&size=10",
					"host": [
						"{{users_host}}"
					],
					"path": [
						"api",
						"instruments",
						"search"
					],
					"query": [
						{
							"key": "instrumentName",
							"value": "percu"
						},
						{
							"key": "page",
							"value": "0"
						},
						{
							"key": "size",
							"value": "10"
						},
						{
							"key": "voice",
							"value": "",
							"disabled": true
						},
						{
							"key": "sort",
							"value": "",
							"disabled": true
						}
					]
				}
			},
			"response": []
		}
	],
	"auth": {
		"type": "oauth2",
		"oauth2": [
			{
				"key": "addTokenTo",
				"value": "header",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	]
}